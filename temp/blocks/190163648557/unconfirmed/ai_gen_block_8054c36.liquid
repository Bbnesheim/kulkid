{% doc %}
  @prompt
    new comprehensive mobile first overlay header with identical logo placement on screen in mobile and desktop view. 
    
    There should be margin (separate for mobile and desktop) and color selectors for all interactive items. 
    
    We also need a underline rainbow animation on hover - and a rainbow animation on press in mobile overlay navigator, hamburger menu in right corner on mobile should be in line with logo, in the center of the banner menu. Then fullscreen overlay with animation on press.
    
    Padding between navigation items on mobile and on desktop
    
    On desktop, border banner with hero below (no overlap), Burger icon cant be pressed
    
    Dont overlap or cover sections above or below
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-overlay-header-{{ ai_gen_id }} {
    position: relative;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    background-color: {{ block.settings.header_bg_color }};
    border-bottom: 1px solid {{ block.settings.border_color }};
    transition: all 0.3s ease;
  }

  .ai-overlay-header-container-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: {{ block.settings.mobile_margin }}px;
    max-width: 100%;
    margin: 0 auto;
    height: {{ block.settings.header_height_mobile }}px;
  }

  .ai-overlay-header-logo-{{ ai_gen_id }} {
    flex-shrink: 0;
    z-index: 1001;
    display: flex;
    align-items: center;
  }

  .ai-overlay-header-logo-{{ ai_gen_id }} img {
    height: {{ block.settings.logo_height }}px;
    width: auto;
    display: block;
  }

  .ai-overlay-header-logo-placeholder-{{ ai_gen_id }} {
    height: {{ block.settings.logo_height }}px;
    width: 120px;
    background-color: {{ block.settings.logo_placeholder_color }};
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
  }

  .ai-overlay-header-logo-placeholder-{{ ai_gen_id }} svg {
    width: 80%;
    height: 80%;
    opacity: 0.5;
  }

  .ai-overlay-header-nav-desktop-{{ ai_gen_id }} {
    display: none;
    flex: 1;
    justify-content: center;
    margin: 0 40px;
  }

  .ai-overlay-header-nav-list-{{ ai_gen_id }} {
    display: flex;
    list-style: none;
    margin: 0;
    padding: 0;
    gap: {{ block.settings.desktop_nav_spacing }}px;
  }

  .ai-overlay-header-nav-item-{{ ai_gen_id }} {
    position: relative;
  }

  .ai-overlay-header-nav-link-{{ ai_gen_id }} {
    color: {{ block.settings.nav_text_color }};
    text-decoration: none;
    font-weight: 500;
    font-size: 16px;
    padding: 8px 0;
    position: relative;
    transition: color 0.3s ease;
  }

  .ai-overlay-header-nav-link-{{ ai_gen_id }}:hover {
    color: {{ block.settings.nav_hover_color }};
  }

  .ai-overlay-header-nav-link-{{ ai_gen_id }}::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background: linear-gradient(90deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);
    background-size: 200% 100%;
    transition: width 0.3s ease;
  }

  .ai-overlay-header-nav-link-{{ ai_gen_id }}:hover::after {
    width: 100%;
    animation: ai-rainbow-flow-{{ ai_gen_id }} 2s linear infinite;
  }

  @keyframes ai-rainbow-flow-{{ ai_gen_id }} {
    0% { background-position: 0% 50%; }
    100% { background-position: 200% 50%; }
  }

  .ai-overlay-header-actions-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 1001;
  }

  .ai-overlay-header-action-btn-{{ ai_gen_id }} {
    background: none;
    border: none;
    color: {{ block.settings.action_icon_color }};
    cursor: pointer;
    padding: 8px;
    border-radius: 4px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    z-index: 1002;
  }

  .ai-overlay-header-action-btn-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.action_hover_bg }};
    color: {{ block.settings.action_hover_color }};
  }

  .ai-overlay-header-action-btn-{{ ai_gen_id }} svg {
    width: 24px;
    height: 24px;
  }

  .ai-overlay-header-menu-btn-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 4px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
    transition: all 0.3s ease;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    position: relative;
    z-index: 1002;
    touch-action: manipulation;
  }

  .ai-overlay-header-menu-btn-{{ ai_gen_id }}:focus {
    outline: 2px solid {{ block.settings.nav_hover_color }};
    outline-offset: 2px;
  }

  .ai-overlay-header-menu-line-{{ ai_gen_id }} {
    width: 24px;
    height: 2px;
    background-color: {{ block.settings.menu_icon_color }};
    transition: all 0.3s ease;
    pointer-events: none;
  }

  .ai-overlay-header-menu-btn-{{ ai_gen_id }}.active .ai-overlay-header-menu-line-{{ ai_gen_id }}:nth-child(1) {
    transform: rotate(45deg) translate(6px, 6px);
  }

  .ai-overlay-header-menu-btn-{{ ai_gen_id }}.active .ai-overlay-header-menu-line-{{ ai_gen_id }}:nth-child(2) {
    opacity: 0;
  }

  .ai-overlay-header-menu-btn-{{ ai_gen_id }}.active .ai-overlay-header-menu-line-{{ ai_gen_id }}:nth-child(3) {
    transform: rotate(-45deg) translate(6px, -6px);
  }

  .ai-overlay-header-mobile-nav-{{ ai_gen_id }} {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: {{ block.settings.mobile_nav_bg }};
    z-index: 999;
    opacity: 0;
    visibility: hidden;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    overflow-y: auto;
  }

  .ai-overlay-header-mobile-nav-{{ ai_gen_id }}.active {
    opacity: 1;
    visibility: visible;
  }

  .ai-overlay-header-mobile-nav-content-{{ ai_gen_id }} {
    padding: {{ block.settings.header_height_mobile | plus: 20 }}px {{ block.settings.mobile_margin }}px {{ block.settings.mobile_margin }}px;
    height: 100%;
    display: flex;
    flex-direction: column;
    transform: translateY(30px);
    transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  .ai-overlay-header-mobile-nav-{{ ai_gen_id }}.active .ai-overlay-header-mobile-nav-content-{{ ai_gen_id }} {
    transform: translateY(0);
  }

  .ai-overlay-header-mobile-nav-list-{{ ai_gen_id }} {
    list-style: none;
    margin: 0;
    padding: 0;
    flex: 1;
  }

  .ai-overlay-header-mobile-nav-item-{{ ai_gen_id }} {
    border-bottom: 1px solid {{ block.settings.mobile_nav_border }};
    opacity: 0;
    transform: translateX(-20px);
    transition: all 0.3s ease;
  }

  .ai-overlay-header-mobile-nav-{{ ai_gen_id }}.active .ai-overlay-header-mobile-nav-item-{{ ai_gen_id }} {
    opacity: 1;
    transform: translateX(0);
  }

  .ai-overlay-header-mobile-nav-item-{{ ai_gen_id }}:nth-child(1) { transition-delay: 0.1s; }
  .ai-overlay-header-mobile-nav-item-{{ ai_gen_id }}:nth-child(2) { transition-delay: 0.15s; }
  .ai-overlay-header-mobile-nav-item-{{ ai_gen_id }}:nth-child(3) { transition-delay: 0.2s; }
  .ai-overlay-header-mobile-nav-item-{{ ai_gen_id }}:nth-child(4) { transition-delay: 0.25s; }
  .ai-overlay-header-mobile-nav-item-{{ ai_gen_id }}:nth-child(5) { transition-delay: 0.3s; }

  .ai-overlay-header-mobile-nav-link-{{ ai_gen_id }} {
    display: block;
    color: {{ block.settings.mobile_nav_text }};
    text-decoration: none;
    font-size: 24px;
    font-weight: 600;
    padding: {{ block.settings.mobile_nav_spacing }}px 0;
    position: relative;
    transition: all 0.3s ease;
  }

  .ai-overlay-header-mobile-nav-link-{{ ai_gen_id }}:active {
    background: linear-gradient(90deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);
    background-size: 200% 100%;
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: ai-rainbow-press-{{ ai_gen_id }} 0.6s ease-out;
  }

  @keyframes ai-rainbow-press-{{ ai_gen_id }} {
    0% { 
      background-position: 0% 50%;
      transform: scale(1);
    }
    50% { 
      background-position: 100% 50%;
      transform: scale(1.05);
    }
    100% { 
      background-position: 200% 50%;
      transform: scale(1);
    }
  }

  .ai-overlay-header-mobile-actions-{{ ai_gen_id }} {
    display: flex;
    justify-content: center;
    gap: 32px;
    padding: 40px 0;
    border-top: 1px solid {{ block.settings.mobile_nav_border }};
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.4s ease;
    transition-delay: 0.2s;
  }

  .ai-overlay-header-mobile-nav-{{ ai_gen_id }}.active .ai-overlay-header-mobile-actions-{{ ai_gen_id }} {
    opacity: 1;
    transform: translateY(0);
  }

  @media screen and (min-width: 768px) {
    .ai-overlay-header-container-{{ ai_gen_id }} {
      padding: {{ block.settings.desktop_margin }}px;
      max-width: {{ settings.page_width }}px;
      height: {{ block.settings.header_height_desktop }}px;
    }

    .ai-overlay-header-nav-desktop-{{ ai_gen_id }} {
      display: flex;
    }

    .ai-overlay-header-menu-btn-{{ ai_gen_id }} {
      display: none;
    }

    .ai-overlay-header-logo-{{ ai_gen_id }} img {
      height: {{ block.settings.logo_height_desktop }}px;
    }

    .ai-overlay-header-logo-placeholder-{{ ai_gen_id }} {
      height: {{ block.settings.logo_height_desktop }}px;
    }
  }

  @media screen and (max-width: 767px) {
    .ai-overlay-header-actions-{{ ai_gen_id }} .ai-overlay-header-action-btn-{{ ai_gen_id }}:not(.ai-overlay-header-menu-btn-{{ ai_gen_id }}) {
      display: none;
    }
  }

  body.ai-overlay-header-no-scroll-{{ ai_gen_id }} {
    overflow: hidden;
  }
{% endstyle %}

<overlay-header-{{ ai_gen_id }} class="ai-overlay-header-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-overlay-header-container-{{ ai_gen_id }}">
    <div class="ai-overlay-header-logo-{{ ai_gen_id }}">
      {% if block.settings.logo %}
        <a href="{{ routes.root_url }}">
          <img
            src="{{ block.settings.logo | image_url: width: 400 }}"
            alt="{{ shop.name | escape }}"
            width="{{ block.settings.logo.width }}"
            height="{{ block.settings.logo.height }}"
            loading="lazy"
          >
        </a>
      {% else %}
        <a href="{{ routes.root_url }}">
          <div class="ai-overlay-header-logo-placeholder-{{ ai_gen_id }}">
            {{ 'image' | placeholder_svg_tag }}
          </div>
        </a>
      {% endif %}
    </div>

    <nav class="ai-overlay-header-nav-desktop-{{ ai_gen_id }}">
      <ul class="ai-overlay-header-nav-list-{{ ai_gen_id }}">
        {% for link in linklists[block.settings.menu].links %}
          <li class="ai-overlay-header-nav-item-{{ ai_gen_id }}">
            <a href="{{ link.url }}" class="ai-overlay-header-nav-link-{{ ai_gen_id }}">
              {{ link.title }}
            </a>
          </li>
        {% endfor %}
      </ul>
    </nav>

    <div class="ai-overlay-header-actions-{{ ai_gen_id }}">
      {% if block.settings.show_search %}
        <button class="ai-overlay-header-action-btn-{{ ai_gen_id }}" aria-label="Search">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </button>
      {% endif %}

      {% if block.settings.show_account %}
        <a href="{{ routes.account_url }}" class="ai-overlay-header-action-btn-{{ ai_gen_id }}" aria-label="Account">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
        </a>
      {% endif %}

      {% if block.settings.show_cart %}
        <a href="{{ routes.cart_url }}" class="ai-overlay-header-action-btn-{{ ai_gen_id }}" aria-label="Cart">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6m8 0V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4.01" />
          </svg>
        </a>
      {% endif %}

      <button 
        class="ai-overlay-header-menu-btn-{{ ai_gen_id }}" 
        aria-label="Menu" 
        aria-expanded="false"
        type="button"
      >
        <span class="ai-overlay-header-menu-line-{{ ai_gen_id }}"></span>
        <span class="ai-overlay-header-menu-line-{{ ai_gen_id }}"></span>
        <span class="ai-overlay-header-menu-line-{{ ai_gen_id }}"></span>
      </button>
    </div>
  </div>

  <nav class="ai-overlay-header-mobile-nav-{{ ai_gen_id }}">
    <div class="ai-overlay-header-mobile-nav-content-{{ ai_gen_id }}">
      <ul class="ai-overlay-header-mobile-nav-list-{{ ai_gen_id }}">
        {% for link in linklists[block.settings.menu].links %}
          <li class="ai-overlay-header-mobile-nav-item-{{ ai_gen_id }}">
            <a href="{{ link.url }}" class="ai-overlay-header-mobile-nav-link-{{ ai_gen_id }}">
              {{ link.title }}
            </a>
          </li>
        {% endfor %}
      </ul>

      <div class="ai-overlay-header-mobile-actions-{{ ai_gen_id }}">
        {% if block.settings.show_search %}
          <button class="ai-overlay-header-action-btn-{{ ai_gen_id }}" aria-label="Search">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
          </button>
        {% endif %}

        {% if block.settings.show_account %}
          <a href="{{ routes.account_url }}" class="ai-overlay-header-action-btn-{{ ai_gen_id }}" aria-label="Account">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
          </a>
        {% endif %}

        {% if block.settings.show_cart %}
          <a href="{{ routes.cart_url }}" class="ai-overlay-header-action-btn-{{ ai_gen_id }}" aria-label="Cart">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6m8 0V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4.01" />
          </svg>
        </a>
      {% endif %}
      </div>
    </div>
  </nav>
</overlay-header-{{ ai_gen_id }}>

<script>
  (function() {
    class OverlayHeader{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.menuBtn = null;
        this.mobileNav = null;
        this.mobileNavLinks = null;
        this.isOpen = false;
      }

      connectedCallback() {
        this.menuBtn = this.querySelector('.ai-overlay-header-menu-btn-{{ ai_gen_id }}');
        this.mobileNav = this.querySelector('.ai-overlay-header-mobile-nav-{{ ai_gen_id }}');
        this.mobileNavLinks = this.querySelectorAll('.ai-overlay-header-mobile-nav-link-{{ ai_gen_id }}');
        
        if (this.menuBtn && this.mobileNav) {
          this.setupEventListeners();
        }
      }

      setupEventListeners() {
        this.menuBtn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          this.toggleMobileNav();
        });

        this.menuBtn.addEventListener('touchstart', (e) => {
          e.preventDefault();
          this.toggleMobileNav();
        }, { passive: false });
        
        this.mobileNavLinks.forEach(link => {
          link.addEventListener('click', () => {
            this.closeMobileNav();
          });
        });

        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && this.isOpen) {
            this.closeMobileNav();
          }
        });

        this.mobileNav.addEventListener('click', (e) => {
          if (e.target === this.mobileNav) {
            this.closeMobileNav();
          }
        });
      }

      toggleMobileNav() {
        if (this.isOpen) {
          this.closeMobileNav();
        } else {
          this.openMobileNav();
        }
      }

      openMobileNav() {
        this.isOpen = true;
        this.menuBtn.classList.add('active');
        this.mobileNav.classList.add('active');
        this.menuBtn.setAttribute('aria-expanded', 'true');
        document.body.classList.add('ai-overlay-header-no-scroll-{{ ai_gen_id }}');
      }

      closeMobileNav() {
        this.isOpen = false;
        this.menuBtn.classList.remove('active');
        this.mobileNav.classList.remove('active');
        this.menuBtn.setAttribute('aria-expanded', 'false');
        document.body.classList.remove('ai-overlay-header-no-scroll-{{ ai_gen_id }}');
      }
    }

    customElements.define('overlay-header-{{ ai_gen_id }}', OverlayHeader{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Overlay header",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_height",
      "min": 20,
      "max": 80,
      "step": 2,
      "unit": "px",
      "label": "Logo height (mobile)",
      "default": 40
    },
    {
      "type": "range",
      "id": "logo_height_desktop",
      "min": 30,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Logo height (desktop)",
      "default": 50
    },
    {
      "type": "color",
      "id": "logo_placeholder_color",
      "label": "Logo placeholder color",
      "default": "#f0f0f0"
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "range",
      "id": "desktop_nav_spacing",
      "min": 16,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Desktop navigation spacing",
      "default": 32
    },
    {
      "type": "range",
      "id": "mobile_nav_spacing",
      "min": 12,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Mobile navigation spacing",
      "default": 20
    },
    {
      "type": "header",
      "content": "Actions"
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "Show search",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_account",
      "label": "Show account",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_cart",
      "label": "Show cart",
      "default": true
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "header_height_mobile",
      "min": 60,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Header height (mobile)",
      "default": 70
    },
    {
      "type": "range",
      "id": "header_height_desktop",
      "min": 70,
      "max": 120,
      "step": 5,
      "unit": "px",
      "label": "Header height (desktop)",
      "default": 80
    },
    {
      "type": "range",
      "id": "mobile_margin",
      "min": 10,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Mobile margin",
      "default": 20
    },
    {
      "type": "range",
      "id": "desktop_margin",
      "min": 20,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Desktop margin",
      "default": 40
    },
    {
      "type": "header",
      "content": "Header colors"
    },
    {
      "type": "color",
      "id": "header_bg_color",
      "label": "Background color",
      "default": "rgba(255, 255, 255, 0.95)"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "rgba(0, 0, 0, 0.1)"
    },
    {
      "type": "header",
      "content": "Navigation colors"
    },
    {
      "type": "color",
      "id": "nav_text_color",
      "label": "Text color",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "nav_hover_color",
      "label": "Hover text color",
      "default": "#666666"
    },
    {
      "type": "header",
      "content": "Action button colors"
    },
    {
      "type": "color",
      "id": "action_icon_color",
      "label": "Icon color",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "action_hover_bg",
      "label": "Hover background",
      "default": "rgba(0, 0, 0, 0.05)"
    },
    {
      "type": "color",
      "id": "action_hover_color",
      "label": "Hover icon color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Menu button colors"
    },
    {
      "type": "color",
      "id": "menu_icon_color",
      "label": "Menu icon color",
      "default": "#121212"
    },
    {
      "type": "header",
      "content": "Mobile navigation colors"
    },
    {
      "type": "color",
      "id": "mobile_nav_bg",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "mobile_nav_text",
      "label": "Text color",
      "default": "#121212"
    },
    {
      "type": "color",
      "id": "mobile_nav_border",
      "label": "Border color",
      "default": "rgba(0, 0, 0, 0.1)"
    }
  ],
  "presets": [
    {
      "name": "Overlay header"
    }
  ]
}
{% endschema %}